<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠ¤ë§ˆíŠ¸ íšŒì˜ë¡ ìƒì„±ê¸°</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&family=Noto+Serif+KR:wght@700&display=swap" rel="stylesheet">
    <style>
        /* [ê¸°ë³¸ ì„¤ì •] */
        * { box-sizing: border-box; }
        body { 
            font-family: 'Noto Sans KR', sans-serif; 
            background-color: #f4f6f9; 
            display: flex; flex-direction: column; align-items: center; 
            padding: 40px 20px; min-height: 100vh; margin: 0;
        }

        /* í™ˆ ë²„íŠ¼ */
        .home-btn {
            position: fixed; top: 20px; left: 20px; width: 50px; height: 50px;
            background-color: #0b2a4a; color: white; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            text-decoration: none; box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            font-size: 24px; z-index: 9999;
        }

        /* ì…ë ¥ íŒ¨ë„ */
        .input-panel {
            background: white; padding: 30px; border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
            max-width: 900px; width: 100%;
            margin-bottom: 50px; border-top: 5px solid #0b2a4a;
        }

        h2 { color: #0b2a4a; margin-top: 0; text-align: center; margin-bottom: 20px; }

        .form-group { margin-bottom: 15px; }
        .form-label { display: block; font-weight: bold; margin-bottom: 5px; color: #555; }
        .form-input { 
            width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 1rem; 
        }
        .form-row { display: flex; gap: 10px; }
        
        /* ë™ì  ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .section-item { 
            background: #f8f9fa; border: 1px solid #e9ecef; padding: 15px; 
            border-radius: 8px; margin-bottom: 10px; position: relative;
        }
        .section-item textarea { height: 80px; resize: vertical; margin-top: 5px; }
        .btn-del-section {
            position: absolute; top: 10px; right: 10px; 
            background: #ffc9c9; color: #c92a2a; border: none; 
            border-radius: 4px; cursor: pointer; padding: 2px 8px; font-size: 0.8rem;
        }

        /* Action Item ìŠ¤íƒ€ì¼ */
        .action-item { display: flex; gap: 5px; margin-bottom: 5px; align-items: center; }
        .action-who { width: 80px; }
        .action-due { width: 120px; }
        .action-what { flex: 1; }

        /* ë²„íŠ¼ */
        .btn {
            padding: 10px 20px; border: none; border-radius: 5px; 
            font-weight: bold; cursor: pointer; color: white; transition: 0.2s;
        }
        .btn-add { background-color: #1098ad; width: 100%; margin-bottom: 15px; }
        .btn-gen { background-color: #0b2a4a; width: 100%; font-size: 1.1rem; padding: 15px; margin-top: 10px; }
        .btn-word { background-color: #2b8a3e; width: 100%; font-size: 1.1rem; padding: 15px; margin-top: 10px; }

        /* [ë¯¸ë¦¬ë³´ê¸° & ì¸ì‡„ìš© A4 ìŠ¤íƒ€ì¼] */
        .sheet {
            background: white; 
            width: 210mm; 
            min-height: 297mm; 
            padding: 25mm;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
            border: 1px solid #dce0e3;
            display: none; /* ì´ˆê¸°ì—” ìˆ¨ê¹€ */
            flex-direction: column;
        }

        /* ë¬¸ì„œ ë‚´ë¶€ ìŠ¤íƒ€ì¼ (ì›Œë“œ ì €ì¥ ì‹œ ì¤‘ìš”) */
        .doc-title { 
            font-size: 24pt; font-weight: bold; text-align: center; margin-bottom: 30px; 
            font-family: 'Malgun Gothic', sans-serif; 
        }
        
        .meta-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        .meta-table th, .meta-table td { border: 1px solid #000; padding: 8px; }
        .meta-table th { background-color: #f1f3f5; width: 100px; text-align: center; font-weight: bold; }

        .content-section { margin-bottom: 20px; }
        .section-title { font-size: 14pt; font-weight: bold; border-bottom: 2px solid #000; padding-bottom: 5px; margin-bottom: 10px; color: #0b2a4a; }
        .section-body { font-size: 11pt; line-height: 1.6; white-space: pre-wrap; }

        .action-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .action-table th, .action-table td { border: 1px solid #000; padding: 6px; text-align: center; font-size: 10pt; }
        .action-table th { background-color: #e7f5ff; }
        .action-table td.left-align { text-align: left; }

    </style>
</head>
<body>

    <a href="index.html" class="home-btn">ğŸ </a>

    <div class="input-panel">
        <h2>ğŸ“ íšŒì˜ë¡ ì‘ì„±</h2>
        
        <div class="form-group">
            <label class="form-label">íšŒì˜ ì£¼ì œ</label>
            <input type="text" id="topic" class="form-input" placeholder="ì˜ˆ: 2026-1í•™ê¸° ì¡¸ì—…ë…¼ë¬¸ ì‹¬ì‚¬ ê³„íš íšŒì˜">
        </div>
        <div class="form-row">
            <div class="form-group" style="flex:1;">
                <label class="form-label">ì¼ì‹œ</label>
                <input type="text" id="date" class="form-input">
            </div>
            <div class="form-group" style="flex:1;">
                <label class="form-label">ì¥ì†Œ</label>
                <input type="text" id="place" class="form-input" value="í•™ê³¼ì¥ì‹¤">
            </div>
        </div>
        <div class="form-group">
            <label class="form-label">ì°¸ì„ì</label>
            <input type="text" id="attendees" class="form-input" placeholder="ì˜ˆ: ê³½ìƒˆë¼ êµìˆ˜ë‹˜, ê¹€ì² ìˆ˜ ì¡°êµ, ì´ì˜í¬ ì¡°êµ">
        </div>

        <hr style="margin: 20px 0; border: 0; border-top: 1px dashed #ccc;">

        <label class="form-label">íšŒì˜ ë‚´ìš© (ì•ˆê±´ë³„ ì •ë¦¬)</label>
        <div id="sectionContainer">
            </div>
        <button class="btn btn-add" onclick="addSection()">+ ì•ˆê±´ ì¶”ê°€í•˜ê¸°</button>

        <hr style="margin: 20px 0; border: 0; border-top: 1px dashed #ccc;">

        <label class="form-label">í–¥í›„ í•  ì¼ (Action Item)</label>
        <div id="actionContainer">
            </div>
        <button class="btn btn-add" style="background-color: #748ffc;" onclick="addAction()">+ í•  ì¼ ì¶”ê°€í•˜ê¸°</button>

        <div style="display: flex; gap: 10px;">
            <button class="btn btn-gen" onclick="renderSheet()">ğŸ“„ íšŒì˜ë¡ ìƒì„± (ë¯¸ë¦¬ë³´ê¸°)</button>
        </div>
    </div>

    <div id="previewSheet" class="sheet"></div>
    
    <div id="saveBtnArea" style="display:none; width: 100%; max-width: 900px; margin-bottom: 50px;">
        <button class="btn btn-word" onclick="exportToWord()">ğŸ’¾ ì›Œë“œ íŒŒì¼(.doc)ë¡œ ì €ì¥</button>
    </div>

    <script>
        // ì´ˆê¸°í™”
        window.onload = function() {
            const now = new Date();
            document.getElementById('date').value = `${now.getFullYear()}.${now.getMonth()+1}.${now.getDate()} (${'ì¼ì›”í™”ìˆ˜ëª©ê¸ˆí† '[now.getDay()]}) ${now.getHours()}:${String(now.getMinutes()).padStart(2,'0')}`;
            
            // ê¸°ë³¸ ì„¹ì…˜ 1ê°œ ì¶”ê°€
            addSection();
            addAction();
        };

        // ì„¹ì…˜ ì¶”ê°€
        function addSection() {
            const div = document.createElement('div');
            div.className = 'section-item';
            div.innerHTML = `
                <button class="btn-del-section" onclick="this.parentElement.remove()">ì‚­ì œ</button>
                <input type="text" class="form-input sec-title" placeholder="ì†Œì œëª© (ì˜ˆ: ì¡¸ì—…ë…¼ë¬¸ ì‹¬ì‚¬ ì¼ì •)" style="font-weight:bold; margin-bottom:5px;">
                <textarea class="form-input sec-content" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”. (ê°œì¡°ì‹ ì¶”ì²œ)"></textarea>
            `;
            document.getElementById('sectionContainer').appendChild(div);
        }

        // Action Item ì¶”ê°€
        function addAction() {
            const div = document.createElement('div');
            div.className = 'action-item';
            div.innerHTML = `
                <input type="text" class="form-input action-who" placeholder="ë‹´ë‹¹ì">
                <input type="text" class="form-input action-what" placeholder="í•  ì¼ ë‚´ìš©">
                <input type="text" class="form-input action-due" placeholder="ê¸°í•œ(ë‚ ì§œ)">
                <button class="btn-del-section" style="position:static;" onclick="this.parentElement.remove()">X</button>
            `;
            document.getElementById('actionContainer').appendChild(div);
        }

        // ë¯¸ë¦¬ë³´ê¸° ìƒì„±
        function renderSheet() {
            const topic = document.getElementById('topic').value || "íšŒì˜ë¡";
            const date = document.getElementById('date').value;
            const place = document.getElementById('place').value;
            const attendees = document.getElementById('attendees').value;

            // [ìˆ˜ì •] ì œëª© í¬ê¸°ë¥¼ íƒœê·¸ì— ì§ì ‘ ì¸ë¼ì¸ìœ¼ë¡œ ë°•ì•„ë²„ë¦¼ (ì›Œë“œ í˜¸í™˜ì„± ê°•í™”)
            let html = `
                <div class="doc-title" style="font-size: 28pt; font-weight: bold; text-align: center; margin-bottom: 30px; font-family: 'Malgun Gothic', sans-serif;">${topic}</div>
                
                <table class="meta-table">
                    <tr>
                        <th style="background:#f1f3f5; width:100px;">ì¼ì‹œ</th><td>${date}</td>
                        <th style="background:#f1f3f5; width:100px;">ì¥ì†Œ</th><td>${place}</td>
                    </tr>
                    <tr>
                        <th style="background:#f1f3f5;">ì°¸ì„ì</th><td colspan="3">${attendees}</td>
                    </tr>
                </table>
            `;

            // ì„¹ì…˜ ë‚´ìš©
            const sections = document.querySelectorAll('.section-item');
            sections.forEach(sec => {
                const title = sec.querySelector('.sec-title').value;
                const content = sec.querySelector('.sec-content').value;
                if(title || content) {
                    html += `
                        <div class="content-section">
                            <div class="section-title" style="font-size: 14pt; border-bottom: 2px solid #000; margin-bottom: 10px; color: #0b2a4a;">â–  ${title}</div>
                            <div class="section-body" style="font-size: 11pt; line-height: 1.6;">${content.replace(/\n/g, '<br>')}</div>
                        </div>
                    `;
                }
            });

            // Action Items
            const actions = document.querySelectorAll('.action-item');
            let actionRows = "";
            let hasAction = false;

            actions.forEach(act => {
                const who = act.querySelector('.action-who').value;
                const what = act.querySelector('.action-what').value;
                const due = act.querySelector('.action-due').value;
                if(who || what) {
                    hasAction = true;
                    // [ìˆ˜ì •] í™•ì¸(Check) ì—´ ì‚­ì œë¨
                    actionRows += `
                        <tr>
                            <td>${who}</td>
                            <td class="left-align">${what}</td>
                            <td>${due}</td>
                        </tr>
                    `;
                }
            });

            if(hasAction) {
                // [ìˆ˜ì •] í™•ì¸ ì—´ í—¤ë” ì‚­ì œ
                html += `
                    <div class="content-section" style="margin-top: 30px;">
                        <div class="section-title" style="color:#c92a2a; font-size: 14pt; border-bottom: 2px solid #c92a2a;">â–  í–¥í›„ ì¶”ì§„ ê³„íš (Action Item)</div>
                        <table class="action-table">
                            <thead>
                                <tr>
                                    <th style="width:20%; background:#e7f5ff;">ë‹´ë‹¹ì</th>
                                    <th style="background:#e7f5ff;">ë‚´ìš©</th>
                                    <th style="width:25%; background:#e7f5ff;">ê¸°í•œ</th>
                                </tr>
                            </thead>
                            <tbody>${actionRows}</tbody>
                        </table>
                    </div>
                `;
            }

            const sheet = document.getElementById('previewSheet');
            sheet.innerHTML = html;
            sheet.style.display = 'flex';
            document.getElementById('saveBtnArea').style.display = 'block';
            sheet.scrollIntoView({ behavior: 'smooth' });
        }

        // ì›Œë“œë¡œ ì €ì¥
        function exportToWord() {
            const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' " +
                "xmlns:w='urn:schemas-microsoft-com:office:word' " +
                "xmlns='http://www.w3.org/TR/REC-html40'> " +
                "<head><meta charset='utf-8'><title>Export HTML to Word</title>" +
                "<style>body{font-family:'Malgun Gothic', sans-serif;} table{border-collapse:collapse; width:100%;} td, th{border:1px solid #000; padding:5px;} </style>" +
                "</head><body>";
            
            const footer = "</body></html>";
            
            // ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ì˜ HTMLì„ ê·¸ëŒ€ë¡œ ê°€ì ¸ì˜´ (ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ í¬í•¨)
            const sourceHTML = header + document.getElementById("previewSheet").innerHTML + footer;

            const source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(sourceHTML);
            const fileDownload = document.createElement("a");
            document.body.appendChild(fileDownload);
            fileDownload.href = source;
            
            const topic = document.getElementById('topic').value || "íšŒì˜ë¡";
            const date = new Date().toISOString().slice(0,10);
            fileDownload.download = `[íšŒì˜ë¡] ${date}_${topic}.doc`;
            
            fileDownload.click();
            document.body.removeChild(fileDownload);
        }
    </script>
</body>
</html>